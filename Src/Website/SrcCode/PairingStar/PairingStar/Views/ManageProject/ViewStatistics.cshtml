@{
    ViewBag.Title = "ViewStatistics";
}

<h2>View Statistics. </h2>
@{
    if (ViewBag.ShowingAllData)
    {
        <h6>Showing All Data. To see data for just past two weeks <a href="@Url.Action("ViewStatistics", "ManageProject", new {isAllData = false})">View</a></h6>

    }
    else
    {
        <h6>This data is for past two weeks. For all data click this link. <a href="@Url.Action("ViewStatistics", "ManageProject", new {isAllData = true})">View</a></h6>

    }
}
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs();
    });
</script>
<style type="text/css">
   .rawData td
   {
       width:150px;
   }
   .rawData .row
   {
       background-color:white;
   }
   .rawData .altrow
   {
       background-color:#dfdfdf;
   }
</style>


<div class="demo">

<div id="tabs" style="float: left;width:100%">
	<ul>
		<li><a href="#tabs-1">Pair Info</a></li>
		<li><a href="#tabs-2">Raw Data</a></li>
		<li><a href="#tabs-3">Graph</a></li>
	</ul>
    <div id="tabs-1">
        <div style="float:left;clear:left;width:320px;border:solid 1px #567842"> 
            <h4>Pair Matrix.</h4>
            @foreach (var pairingInfo in @ViewBag.CollatedPairDetails)
            {
                <div style="float:left;clear:left;width:300px">
                    <div class="userpanelpairsextn" style="float:left;" > 
                        @pairingInfo.FirstPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.FirstPair.ID })' width="70px" height="70px" />    
                    </div>
                    <div style="float:left;margin-left:60px;margin-top: 50px; ">@pairingInfo.WorkedFor</div>
             
                    <div class="userpanelpairsextn" style="float:right;" > 
                        @pairingInfo.SecondPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.SecondPair.ID })' width="70px" height="70px" />    
                    </div>
               
                </div>
                <br/>
            }
        
        </div>
        
        <div style="float:left;width:320px;border:solid 1px #567842;margin-left:30px;">
            <h4>Have not paired at all</h4>
            
            @foreach (var pairingInfo in @ViewBag.NotPairedInfo)
            {
                <div style="float:left;clear:left;width:300px">
                    <div class="userpanelpairsextn" style="float:left;" > 
                        @pairingInfo.FirstPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.FirstPair.ID })' width="70px" height="70px" />    
                    </div>
                    <div style="float:left;margin-left:60px;margin-top: 50px; ">@pairingInfo.WorkedFor</div>
             
                    <div class="userpanelpairsextn" style="float:right;" > 
                        @pairingInfo.SecondPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.SecondPair.ID })' width="70px" height="70px" />    
                    </div>
               
                </div>
                <br/>
            }
        
        </div>
        
        <div style="float:left;width:320px;border:solid 1px #567842;margin-left:30px;">
            <h4>Lone Pairing people</h4> 
           @foreach (var pairingInfo in @ViewBag.LonePairedInfo)
           {
                <div style="float:left;clear:left;width:300px">
                    <div class="userpanelpairsextn" style="float:left;" > 
                        @pairingInfo.FirstPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.FirstPair.ID })' width="70px" height="70px" />    
                    </div>
                    <div style="float:left;margin-left:60px;margin-top: 50px; ">@pairingInfo.WorkedFor</div>
             
                    <div class="userpanelpairsextn" style="float:right;" > 
                        @pairingInfo.SecondPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.SecondPair.ID })' width="70px" height="70px" />    
                    </div>
               
                </div>
                <br/>
           }
        
        </div>
        
        
        <div style="float:left;width:320px;border:solid 1px #567842;margin-left:30px;">
            <h4>Suggestions</h4>
            
            @foreach (var pairingInfo in @ViewBag.NotPairedInfo)
            {
                <div style="float:left;clear:left;width:300px">
                    <div class="userpanelpairsextn" style="float:left;" > 
                        @pairingInfo.FirstPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.FirstPair.ID })' width="70px" height="70px" />    
                    </div>
                    <div style="float:left;margin-left:60px;margin-top: 50px; ">@pairingInfo.WorkedFor</div>
             
                    <div class="userpanelpairsextn" style="float:right;" > 
                        @pairingInfo.SecondPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.SecondPair.ID })' width="70px" height="70px" />    
                    </div>
               
                </div>
                <br/>
            }
            
            
            @foreach (var pairingInfo in @ViewBag.SuggestionPairDetails)
            {
                <div style="float:left;clear:left;width:300px">
                    <div class="userpanelpairsextn" style="float:left;" > 
                        @pairingInfo.FirstPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.FirstPair.ID })' width="70px" height="70px" />    
                    </div>
             
                    <div class="userpanelpairsextn" style="float:right;margin-left: 50px" > 
                        @pairingInfo.SecondPair.UserName <br/>
                        <img src='@Url.Action("show", "ManageProject", new { id = pairingInfo.SecondPair.ID })' width="70px" height="70px" />    
                    </div>
               
                </div>
                <br/>
            }
        
        
        </div>
        

        
        
    </div>
    <div id="tabs-2">
        
	        <table class="rawData">        
        <tr style="background-color:#5c87b2;color:White"><td>Pair One</td><td>Pair Two</td><td>Pair Date</td><td>Pair Time</td></tr>
        @{var count = 0;
          var cssName = "row";
          }

        @foreach (var pairingDetail in ViewBag.PairingDetails)
        {
            cssName = (count % 2 == 0) ? "row" : "altrow";
            count++;
                  
        <tr class="@cssName">
        <td> @pairingDetail["pairone"]</td>
        <td> @pairingDetail["pairtwo"]</td>
        <td> @pairingDetail["pairdate"]</td>
        <td> @pairingDetail["pairtime"]</td>
        </tr>    
        }
        </table>               
    </div>
    <div id="tabs-3" style="float:left">
        <script type="text/javascript">

            $(document).ready(function () {
                $("#Users").change(function () {
                    var strSelected = "";
                    $("#Users option:selected").each(function () {
                        strSelected += $(this)[0].value;
                    });
                    var urlForUpdatePairDetails = "@Url.Action("GetPairingInfo", "ManageProject")";
                    var url = urlForUpdatePairDetails + "/?pairName=" + strSelected;

                    $.ajax({
                        url: url,
                        success: pairDataReceived,
                        error: function (e) { alert(e.responseText); },
                        cache: false
                    });
                });
                
                var pairDataReceived = function (data) {
                    var pairingInfoOfAUser = data;
                    pairingStar.pairPlumb.reset();
                    _.each(pairingInfoOfAUser, function (pairInfo) {
                        var plumb = pairingStar.pairPlumb;
                        plumb.addDisc();
                    });


                };
            });
        </script>
        @Html.DropDownList("Users", new SelectList((IEnumerable<string>)ViewBag.UserNames))
        
        <div id="pairingCloud"></div>

    </div>
</div>

</div>

